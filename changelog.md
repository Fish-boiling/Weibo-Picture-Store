# Changelog

> 更新日志

## Notice

公告：由于部分应用商店的发布策略变更，导致此扩展的发布周期延长。同时此扩展为非盈利性项目，本人并无太多时间去应对应用商店的要求。因此决定，此后的应用商店的发布计划**可能**无限期延期，若有需要，可自由使用源码。

### 6.0.0

-   新增：支持自定义链接，请查看[自定义剪裁格式或链接](docs/custom-clip.md)使用文档
-   调整：最低版本提升：Chrome(66 -> 110)、Firefox(68 -> 115)
-   调整：Popup 由弹窗改为 Tab 页（受限于 ServiceWorker）
-   调整：Chrome 右键上传不再支持 SVG（受限于 ServiceWorker，弹窗模式仍然支持 SVG）
-   更新：支持 Manifest V3
    -   迁移至 TypeScript
    -   使用 Chrome.storage 替代 WebStorage
    -   简化 Chrome.storage 读取

### 5.12.10

-   修复：Firefox 兼容性问题导致历史记录图片不显示

### 5.12.9

-   新增：支持 avif 图片格式
-   调整：移除 `tva[1-4]` 的域名前缀

### 5.12.7

-   修复：含有 `<foreignObject>` 的 binary SVGImage 会污染画布，导致上传 SVG 失败

### 5.12.6

-   新增：火狐支持上传 blob 视频帧

### 5.12.3

-   增强：右键上传会重试无 Referer 的情况
-   增强：调整提示信息（由于火狐不支持 contextMessage）
-   修复：火狐无法复制到剪切板的问题
-   调整：历史页面使用 100% 宽度

### 5.12.0

-   变更：微博相关的 API 全部使用 https，防止 ISP 劫持 cookie
-   调整：移除冗余的用户提示信息
-   调整：SVG 图片宽高检测优化
-   调整：右键上传默认不再伪造 HTTP Referer（可在选项中启用此功能）
    -   原因：此功能需要宽泛的权限，添加此权限难以通过商店审核
    -   影响：右键上传可能会出现"读取远程文件失败"的问题

### 5.11.2

-   重要：新版仅支持 Firefox 68+

### 5.11.1

-   新增：支持 Firefox 66+ 浏览器
-   新增：支持 Command(macOS) 多选操作

### 5.11.0

-   变更：更新图床域名，尝试解决部分地区无法外链的问题

### 5.10.0

-   新增：历史记录页面新增前往微相册按钮
-   变更：弹窗中的协议设置变更为全局设置

### 5.9.1

-   修复：用户已登录，图片上传失败问题

### 5.9.0

-   修复：某些情况下产生致命错误后，仍然会上传队列文件的问题
-   调整：移除冗余的用户提示信息
    -   右键上传，自动复制 URL 到剪切板，只在复制失败时提示用户
    -   弹窗上传，用户复制 URL 到剪切板，只在复制失败时提示用户
    -   弹窗上传，只在有上传失败或者丢弃文件时，才显示上传结果的统计数据

### 5.8.0

-   新增：支持继承微博图片水印（默认关闭，可在选项中开启）
-   调整：HTML、Markdown 链接中的 alt 属性优先使用文件名称

### 5.7.0

-   新增：记住上传弹窗窗口的尺寸大小
-   新增：重新支持 SVG 转 png 功能（最终的图片宽度根据用户屏幕大小预测）
-   修复：部分视频不能置顶导致无法捕获的问题
-   性能：缩小 chrome.webRequest 的拦截范围
-   变更：拆分不同种类的上传进度提示，并且移除 Notification 的上传进度提示
-   提示：移除通过右键菜单上传时的下载提示
-   提示：右键菜单上传的进度提示通过数字显示在扩展图标上
-   提示：弹窗上传的进度提示通过文字显示在窗口标题上
-   提示：弹窗上传结束后提示上传结果的统计数据

### 5.6.1

-   新增：支持使用微博账号和密码自动登录（需在选项中配置微博账号信息）
-   修复：Chrome Canary(72+) APIs 改动导致接口调用失败的问题

### 5.5.0

-   新增：支持拖拽上传文件夹中的图片文件（支持递归文件夹）
-   新增：支持多相册，在图片存满后会创建另一个相册（测试程度低）
-   调整：上传进度提示改为文字提示

### 5.4.5

-   调整：弹窗中生成的 HTML 标签添加 width 属性

### 5.4.4

-   调整：弹窗的默认协议使用 https
-   措施：由于 [issue 899527](https://bugs.chromium.org/p/chromium/issues/detail?id=899527) 的问题，上传进度提示暂时取消常驻状态

### 5.4.2

-   调整：可以通过快捷键置顶图片文件，让右键可以捕获图片

### 5.4.1

-   修复：导致 `WebP` 等格式的图片上传失败的一处递归错误

### 5.4.0

-   新增：导出日志功能，便于分析问题的原因
-   调整：用户处于已登录状态，上传失败不再中断后续队列

### 5.3.0

-   移除：微博图片用户信息卡（CSP 及框架之间的跨越问题造成普适性较差）
-   移除：周期性请求用户状态（不具有实用性）
-   调整：使用样式注入而不是插入样式（样式注入不受网站的 CSP 策略影响）
-   新增：通知我更新详情（可选关闭更新时的日志弹窗）

### 5.2.2

-   新增：快捷键 `Alt+Shift+C` 来禁用/启用当前域名下的微博信息卡功能

### 5.2.1

-   新增：微博图片用户信息卡，一键查看图片 PO 主的信息（可以在选项页面中启用此功能）

### 5.2.0

-   优化：重新设计微博相关的 APIs，移除冗余的代码
-   新增：长期保持微博用户登录状态的功能（可以在选项页面中启用此功能）

### 5.1.1

-   恢复：网页图片、视频帧的采集自动写入剪切板

### 5.1.0

-   移除：腾讯云存储(COS)+万象优图的图片处理功能
-   其他：接入 V4 版本的功能，详情请查看 V4 版本的更新记录

### 4.0.0 (Beta)

-   移除：网页增强功能，取消自定义微博传图（breaking change）
-   调整：上传记录页面改为瀑布流模式（UX breaking change）
-   调整：网页图片、视频帧的采集不在自动写入剪切板（breaking change）
-   新增：支持腾讯云存储(COS)+万象优图的图片处理
-   新增：上传记录中的图片支持批量删除

### 3.2.0

-   重要：新版仅支持 Chrome 66+
-   移除：对 weibo.com 域下 cookies 的 secure 属性校验和警告提示
-   调整：自动置前已打开的上传弹窗，不在用闪烁表示上传窗口已打开
-   优化：粘贴区域扩展到弹窗大小，消除多余的点击操作（UX breaking change）

### 3.1.0

-   重要：新版仅支持 Chrome 65+（降级浏览器至 65 以下无法使用此扩展）
-   改版：完全启用 ES-next Modules
-   优化：更换为新的上传接口（感谢 @xmdhs 提供新接口信息）
-   优化：弹窗上传页面最大适应至浏览器 125% 的放大效果

### 2.2.9

-   新增：打开上传窗口的快捷键（Shift+Alt+W）
-   新增：对 weibo.com 域下 cookies 的 secure 属性校验和警告提示

### 2.2.8

-   冲突：解决 [LeaVerou/prefixfree](https://github.com/LeaVerou/prefixfree/issues/6131) bug 引起样式泄漏的问题

### 2.2.5

-   修复：QQ 邮箱重用扩展注入的 Style 导致的样式泄露问题

### 2.2.3

-   新增：支持把视频的当前帧上传为 JPG 图像
-   其他：汉化上传弹窗中的部分英文词组

### 2.2.1

-   改动：上传方式改为串行，预防微博限制并发数量而导致上传失败
-   其他：代码风格的变动，部分借鉴 Angular 2.0+ 的编码规范

### 2.1.0

-   改动：用户模块中的属性变更，由 postfix 改为 suffix（breaking change）
-   移除：不再支持 SVG 有损转换为 PNG
-   优化：从字节流中读取图片正确的 MIME Type

### 2.0.0

-   改版：2.0.0
-   完善：所有图片的上传和下载操作均支持进度显示
-   优化：右键上传获取图片时，应用 Referer 请求头

### 1.6.1

-   修复：微相册达到存储上限后不能添加图片（现在自动移除最前的 50 张图片）

### 1.6.0

-   新增：BMP、WebP、ico、SVG 格式支持（有损转换为 PNG）

### 1.5.1

-   修复：国外网络下打开微博登录页面不正确的问题

### 1.5.0

-   优化：自动重试微博登录，不再频繁提示微博未登录
-   修复：潜在的重复创建微相册的问题
-   完善：支持 Animated PNG(APNG) 标准的 MIME Type
